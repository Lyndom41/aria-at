<!-- This is an annotated example of a new formatted the test files.

  The test file format needs to be updated such that one test file and can
  diffed against another test file and we determine if the test has changed or
  not.

  We want to do this in order to be able to determine automatically if test
  results are valid across versions.
-->

<!DOCTYPE html>
<meta charset="utf-8">
<title>Navigate to an unchecked checkbox in reading mode</title>
<link rel="help" href="https://w3c.github.io/aria-practices/#checkbox">
<link rel="help" href="https://w3c.github.io/aria/#checkbox">
<link rel="help" href="https://w3c.github.io/aria/#aria-checked">

<script>
  // PLAN: Instead of having all the scripts live in a seperate script file
  // Inline only the scripts relevant to this specific test file on generateion
  var scripts = {}
</script>
<script type="module">
  // PLAN: Leave the import of the harness file
  // Changes to the test harness shouldn't cause material changes to the meaning
  // of the test results especially as the test harness become more stable
  import { initialize, verifyATBehavior, displayTestPageAndInstructions } from "../resources/aria-at-harness.mjs";

  // PLAN: Inline all files except for the support.json file
  // The only part of the support.json file that is used in the creation of the
  // tests is the mapping from at.key to at.name which doesn't actually change
  // sematic meaning of the test. By leaving it in its own file we don't have to
  // worry about it meaning that changes to that cause a lot unnessicary test
  // invalidation
    new Promise((resolve) => {
      fetch('../support.json')
        .then(response => resolve(response.json()))
    })
    .then(supportJson => {
      // PLAN: Inline the entire test-01-navigate-to-unchecked-checkbox-reading.json
      // file instead of fetching it
      // All of the information in is specific to this test
      const testJson = {
        "setup_script_description": "",
        "setupTestPage": "",
        "applies_to": [
          "jaws",
          "nvda"
        ],
        "mode": "reading",
        "task": "navigate to unchecked checkbox",
        "specific_user_instruction": "Navigate to the first checkbox. Note: it should be in the unchecked state.",
        "output_assertions": [
          [
            "1",
            "Role 'checkbox' is conveyed"
          ],
          [
            "1",
            "Name 'Lettuce' is conveyed"
          ],
          [
            "1",
            "State of the checkbox (not checked) is conveyed"
          ]
        ]
      }

      // PLAN: Remove the seperate command.js file for each example and inline the
      // commands specific only to this test
      const commandsJson = {
        "navigate to unchecked checkbox": {
          "reading": {
            "jaws": [
              [ "X_AND_SHIFT_X" ],
              [ "F_AND_SHIFT_F" ],
              [ "TAB_AND_SHIFT_TAB" ],
              [ "UP_AND_DOWN" ],
              [
                "LEFT_AND_RIGHT",
                "(with Smart Navigation on)"
              ]
            ],
            "nvda": [
              [ "X_AND_SHIFT_X" ],
              [ "F_AND_SHIFT_F" ],
              [ "TAB_AND_SHIFT_TAB" ],
              [ "UP_AND_DOWN" ]
            ]
          },
        }
      }

      initialize(supportJson, commandsJson);
      verifyATBehavior(testJson);
      // PLAN: The test author still refers in reference to the relevant reference
      // file under test that is copied into this repo
      // Instead of having the test be manually copied into the repo add a script
      // that wi ll automatically copy the reference example from
      // https://github.com/w3c/aria-practices/examples
      // and use the same file structure as aria-practices.
      // The script will prompt the test author if a example changes and let the
      // author choose if and when to update the example code
      displayTestPageAndInstructions("checkbox/checkbox-1-SOMESHA.html");
    });
</script>
